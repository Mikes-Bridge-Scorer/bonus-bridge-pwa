{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\mikec\\\\MikesBridge\\\\bonusbridge\\\\src\\\\App.js\",\n  _s = $RefreshSig$();\nimport React, { useState, useEffect, useCallback } from 'react';\nimport WelcomePage from './components/WelcomePage';\nimport TrialManager from './utils/TrialManager'; // NEW: Trial system import\nimport TrialPopup from './components/TrialPopup'; // NEW: Trial popup import\nimport BridgeGameUI from './BridgeGameUI';\nimport ScoreAdjustment from './components/ScoreAdjustment';\nimport FinalScoreAnalysis from './components/FinalScoreAnalysis';\nimport ScoreProcessor from './components/ScoreProcessor';\nimport GameScoreSheet from './components/GameScoreSheet';\nimport { determineVulnerability, parseContract, calculateBridgeScore } from './utils/scoring';\nimport './global.css';\nimport { jsxDEV as _jsxDEV, Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst App = () => {\n  _s();\n  // Welcome page state\n  const [showWelcome, setShowWelcome] = useState(true);\n\n  // NEW: Trial management state\n  const [trialManager] = useState(new TrialManager());\n  const [showTrialPopup, setShowTrialPopup] = useState(false);\n  const [trialType, setTrialType] = useState('info'); // 'info', 'warning', 'expired'\n\n  // State to track current view (main game, score adjustment, or final analysis)\n  const [currentView, setCurrentView] = useState('game');\n\n  // Game state with updated scores structure\n  const [gameState, setGameState] = useState({\n    gameNumber: 1,\n    dealNumber: 1,\n    deals: [],\n    scores: {\n      // Standard bridge (Party Bridge) scores\n      nsPoints: 0,\n      ewPoints: 0,\n      nsTotal: 0,\n      ewTotal: 0,\n      // Bonus Bridge scores - separate tracking\n      bonusNsPoints: 0,\n      bonusEwPoints: 0,\n      bonusNsTotal: 0,\n      bonusEwTotal: 0,\n      // Track which deal number we're on\n      currentDealNumber: 1\n    },\n    currentDeal: {\n      dealNumber: 1,\n      vulnerable: determineVulnerability(1),\n      contract: '',\n      result: null,\n      tricks: null,\n      // Standard bridge scores\n      nsPoints: 0,\n      ewPoints: 0,\n      rawScore: 0,\n      // Bonus bridge scores\n      bonusNsPoints: 0,\n      bonusEwPoints: 0,\n      bonusRawScore: 0,\n      bonusScoringEnabled: true,\n      handAnalysis: null\n    },\n    showScorePopup: false,\n    isAwake: false,\n    gameEnded: false\n  });\n\n  // NEW: Check trial status when app loads\n  useEffect(() => {\n    // Check for expiry first\n    if (trialManager.isExpired()) {\n      setTrialType('expired');\n      setShowTrialPopup(true);\n      return;\n    }\n\n    // Check for warnings\n    if (trialManager.shouldShowWarning()) {\n      setTrialType('warning');\n      setShowTrialPopup(true);\n      return;\n    }\n\n    // Show welcome popup on first visit (optional)\n    const isFirstVisit = !sessionStorage.getItem('trial_seen');\n    if (isFirstVisit && !showWelcome) {\n      setTrialType('info');\n      setShowTrialPopup(true);\n      sessionStorage.setItem('trial_seen', 'true');\n    }\n  }, [trialManager, showWelcome]);\n\n  // Function to start the game from welcome page\n  const handleStartGame = () => {\n    setShowWelcome(false);\n\n    // Show trial info after welcome if first visit\n    const isFirstVisit = !sessionStorage.getItem('trial_seen');\n    if (isFirstVisit) {\n      setTimeout(() => {\n        setTrialType('info');\n        setShowTrialPopup(true);\n        sessionStorage.setItem('trial_seen', 'true');\n      }, 500);\n    }\n  };\n\n  // NEW: Handle trial popup close\n  const handleTrialPopupClose = () => {\n    // Can't close expired popup without extension\n    if (trialType !== 'expired') {\n      setShowTrialPopup(false);\n    }\n  };\n\n  // NEW: Handle trial extension\n  const handleTrialExtended = () => {\n    setShowTrialPopup(false);\n    // Refresh trial status\n    if (trialManager.shouldShowWarning()) {\n      setTrialType('warning');\n    } else {\n      setTrialType('info');\n    }\n  };\n\n  // Function to handle score calculation from ScoreProcessor\n  const handleScoreCalculated = scoreResult => {\n    const {\n      nsPoints,\n      ewPoints,\n      rawScore\n    } = scoreResult;\n    console.log('App received score calculation:', scoreResult);\n\n    // Update the current deal with the calculated scores\n    setGameState(prevState => {\n      // Check if scores have changed\n      if (prevState.currentDeal.nsPoints === nsPoints && prevState.currentDeal.ewPoints === ewPoints) {\n        return prevState; // No change needed\n      }\n      const updatedCurrentDeal = {\n        ...prevState.currentDeal,\n        nsPoints,\n        ewPoints,\n        rawScore: rawScore || Math.max(Math.abs(nsPoints), Math.abs(ewPoints))\n      };\n\n      // Calculate which team gets the raw score based on which has positive points\n      const nsScores = nsPoints > 0;\n      const ewScores = ewPoints > 0;\n\n      // Calculate running totals for Party Bridge (standard) scoring\n      // Only add raw score to the running total of the team that scored\n      const calculatedNsTotal = nsScores ? (prevState.scores.nsTotal || 0) + rawScore : prevState.scores.nsTotal || 0;\n      const calculatedEwTotal = ewScores ? (prevState.scores.ewTotal || 0) + rawScore : prevState.scores.ewTotal || 0;\n\n      // Log the calculation details\n      console.log('Party Bridge (standard) score calculation:', {\n        previousNsTotal: prevState.scores.nsTotal || 0,\n        previousEwTotal: prevState.scores.ewTotal || 0,\n        nsScores,\n        ewScores,\n        rawScore,\n        newNsTotal: calculatedNsTotal,\n        newEwTotal: calculatedEwTotal\n      });\n\n      // Updated scores with correct running totals\n      const updatedScores = {\n        ...prevState.scores,\n        nsPoints,\n        ewPoints,\n        nsTotal: calculatedNsTotal,\n        ewTotal: calculatedEwTotal,\n        currentDealNumber: prevState.dealNumber\n      };\n      console.log('Updating score state:', {\n        currentDeal: updatedCurrentDeal,\n        scores: updatedScores\n      });\n      return {\n        ...prevState,\n        currentDeal: updatedCurrentDeal,\n        scores: updatedScores\n      };\n    });\n  };\n\n  // Function to update current deal\n  const updateCurrentDeal = useCallback(dealUpdates => {\n    setGameState(prevState => ({\n      ...prevState,\n      currentDeal: {\n        ...prevState.currentDeal,\n        ...dealUpdates\n      }\n    }));\n  }, []);\n\n  // Function to handle adjustment input\n  const handleSaveAdjustment = adjustmentData => {\n    setGameState(prevState => ({\n      ...prevState,\n      currentDeal: {\n        ...prevState.currentDeal,\n        handAnalysis: adjustmentData,\n        bonusScoringEnabled: true\n      }\n    }));\n    setCurrentView('analysis');\n  };\n\n  // Function to handle score analysis saving - UPDATED with trial check\n  const handleSaveAnalysis = scoreResult => {\n    // NEW: Check trial limit before proceeding\n    if (!trialManager.canPlayDeals()) {\n      setTrialType('expired');\n      setShowTrialPopup(true);\n      return; // Block progression\n    }\n    console.log('Handling save analysis with result:', scoreResult);\n\n    // Extract the complete deal with bonus scores\n    const currentDealWithBonusScores = scoreResult.currentDealWithBonusScores || {\n      ...gameState.currentDeal,\n      dealNumber: gameState.dealNumber,\n      bonusNsPoints: scoreResult.nsPoints || 0,\n      // Store as bonus scores\n      bonusEwPoints: scoreResult.ewPoints || 0 // Store as bonus scores\n    };\n\n    // Calculate raw score for bonus scoring if not provided\n    const bonusRawScore = Math.max(Math.abs(scoreResult.nsPoints || 0), Math.abs(scoreResult.ewPoints || 0));\n\n    // Calculate running totals for bonus scoring\n    const nsScores = scoreResult.nsPoints > 0;\n    const ewScores = scoreResult.ewPoints > 0;\n    const bonusNsTotal = nsScores ? (gameState.scores.bonusNsTotal || 0) + bonusRawScore : gameState.scores.bonusNsTotal || 0;\n    const bonusEwTotal = ewScores ? (gameState.scores.bonusEwTotal || 0) + bonusRawScore : gameState.scores.bonusEwTotal || 0;\n    console.log('Bonus Bridge score calculation:', {\n      nsScores,\n      ewScores,\n      bonusRawScore,\n      previousBonusNsTotal: gameState.scores.bonusNsTotal || 0,\n      previousBonusEwTotal: gameState.scores.bonusEwTotal || 0,\n      newBonusNsTotal: bonusNsTotal,\n      newBonusEwTotal: bonusEwTotal\n    });\n\n    // Store the complete deal with both raw and bonus scores\n    const completeCurrentDeal = {\n      ...currentDealWithBonusScores,\n      rawScore: currentDealWithBonusScores.rawScore || 0,\n      // Party Bridge score\n      bonusRawScore: bonusRawScore,\n      // Bonus Bridge score\n      nsPoints: currentDealWithBonusScores.nsPoints || 0,\n      // Party Bridge points\n      ewPoints: currentDealWithBonusScores.ewPoints || 0,\n      // Party Bridge points\n      bonusNsPoints: scoreResult.nsPoints || 0,\n      // Bonus Bridge points\n      bonusEwPoints: scoreResult.ewPoints || 0 // Bonus Bridge points\n    };\n\n    // NEW: Increment deal counter\n    const canContinue = trialManager.incrementDeals();\n\n    // Update game state with new deal\n    setGameState(prevState => {\n      return {\n        ...prevState,\n        dealNumber: prevState.dealNumber + 1,\n        deals: [...prevState.deals, completeCurrentDeal],\n        scores: {\n          ...prevState.scores,\n          // Reset current deal scores to 0\n          nsPoints: 0,\n          ewPoints: 0,\n          // Preserve running totals for both scoring systems\n          nsTotal: prevState.scores.nsTotal || 0,\n          ewTotal: prevState.scores.ewTotal || 0,\n          bonusNsTotal: bonusNsTotal,\n          bonusEwTotal: bonusEwTotal,\n          currentDealNumber: prevState.dealNumber + 1\n        },\n        currentDeal: {\n          dealNumber: prevState.dealNumber + 1,\n          vulnerable: determineVulnerability(prevState.dealNumber + 1),\n          contract: '',\n          result: null,\n          tricks: null,\n          nsPoints: 0,\n          ewPoints: 0,\n          rawScore: 0,\n          bonusNsPoints: 0,\n          bonusEwPoints: 0,\n          bonusRawScore: 0,\n          bonusScoringEnabled: true,\n          handAnalysis: null\n        },\n        showScorePopup: false\n      };\n    });\n\n    // NEW: Check trial status after increment\n    if (!canContinue) {\n      setTrialType('expired');\n      setShowTrialPopup(true);\n    } else if (trialManager.shouldShowWarning()) {\n      setTrialType('warning');\n      setShowTrialPopup(true);\n    }\n\n    // Return to the game view\n    setCurrentView('game');\n  };\n\n  // Function to handle next deal without adjustments - UPDATED with trial check\n  const handleNextDeal = (currentDealWithScores = null, updatedScores = null) => {\n    // NEW: Check trial limit before proceeding\n    if (!trialManager.canPlayDeals()) {\n      setTrialType('expired');\n      setShowTrialPopup(true);\n      return; // Block progression\n    }\n\n    // Use provided scores or current state\n    const dealToSave = currentDealWithScores || gameState.currentDeal;\n    const scoresToUse = updatedScores || gameState.scores;\n\n    // Ensure the deal has scores\n    if (!dealToSave.nsPoints && !dealToSave.ewPoints && dealToSave.contract) {\n      // Calculate if needed\n      const contractDetails = parseContract(dealToSave.contract, dealToSave.result, dealToSave.vulnerable);\n      if (contractDetails) {\n        const standardScore = calculateBridgeScore(contractDetails);\n\n        // Calculate raw score\n        const rawScore = Math.max(Math.abs(standardScore.nsPoints || 0), Math.abs(standardScore.ewPoints || 0));\n\n        // Update scores\n        dealToSave.nsPoints = standardScore.nsPoints || 0;\n        dealToSave.ewPoints = standardScore.ewPoints || 0;\n        dealToSave.rawScore = rawScore;\n\n        // Determine which team scores positive points\n        const nsScores = standardScore.nsPoints > 0;\n        const ewScores = standardScore.ewPoints > 0;\n\n        // Calculate running totals for Party Bridge\n        const calculatedNsTotal = nsScores ? (scoresToUse.nsTotal || 0) + rawScore : scoresToUse.nsTotal || 0;\n        const calculatedEwTotal = ewScores ? (scoresToUse.ewTotal || 0) + rawScore : scoresToUse.ewTotal || 0;\n        console.log('Next deal Party Bridge score calculation:', {\n          nsScores,\n          ewScores,\n          rawScore,\n          previousNsTotal: scoresToUse.nsTotal || 0,\n          previousEwTotal: scoresToUse.ewTotal || 0,\n          newNsTotal: calculatedNsTotal,\n          newEwTotal: calculatedEwTotal\n        });\n\n        // NEW: Increment deal counter\n        const canContinue = trialManager.incrementDeals();\n\n        // Update game state with new deal\n        setGameState(prevState => {\n          return {\n            ...prevState,\n            dealNumber: prevState.dealNumber + 1,\n            deals: [...prevState.deals, dealToSave],\n            scores: {\n              ...prevState.scores,\n              nsPoints: 0,\n              // Reset to 0 for the new deal\n              ewPoints: 0,\n              // Reset to 0 for the new deal\n              nsTotal: calculatedNsTotal,\n              ewTotal: calculatedEwTotal,\n              // Keep bonus scores unchanged\n              bonusNsTotal: prevState.scores.bonusNsTotal || 0,\n              bonusEwTotal: prevState.scores.bonusEwTotal || 0,\n              currentDealNumber: prevState.dealNumber + 1\n            },\n            currentDeal: {\n              dealNumber: prevState.dealNumber + 1,\n              vulnerable: determineVulnerability(prevState.dealNumber + 1),\n              contract: '',\n              result: null,\n              tricks: null,\n              nsPoints: 0,\n              ewPoints: 0,\n              rawScore: 0,\n              bonusNsPoints: 0,\n              bonusEwPoints: 0,\n              bonusRawScore: 0,\n              bonusScoringEnabled: true,\n              handAnalysis: null\n            },\n            showScorePopup: false\n          };\n        });\n\n        // NEW: Check trial status after increment\n        if (!canContinue) {\n          setTrialType('expired');\n          setShowTrialPopup(true);\n        } else if (trialManager.shouldShowWarning()) {\n          setTrialType('warning');\n          setShowTrialPopup(true);\n        }\n      }\n    } else {\n      // Already has scores, just save and proceed\n      const rawScore = dealToSave.rawScore || Math.max(Math.abs(dealToSave.nsPoints || 0), Math.abs(dealToSave.ewPoints || 0));\n      const nsScores = dealToSave.nsPoints > 0;\n      const ewScores = dealToSave.ewPoints > 0;\n      const calculatedNsTotal = nsScores ? (scoresToUse.nsTotal || 0) + rawScore : scoresToUse.nsTotal || 0;\n      const calculatedEwTotal = ewScores ? (scoresToUse.ewTotal || 0) + rawScore : scoresToUse.ewTotal || 0;\n      console.log('Next deal with existing scores:', {\n        nsScores,\n        ewScores,\n        rawScore,\n        previousNsTotal: scoresToUse.nsTotal || 0,\n        previousEwTotal: scoresToUse.ewTotal || 0,\n        newNsTotal: calculatedNsTotal,\n        newEwTotal: calculatedEwTotal\n      });\n\n      // NEW: Increment deal counter\n      const canContinue = trialManager.incrementDeals();\n\n      // Update game state with new deal\n      setGameState(prevState => {\n        return {\n          ...prevState,\n          dealNumber: prevState.dealNumber + 1,\n          deals: [...prevState.deals, dealToSave],\n          scores: {\n            ...prevState.scores,\n            nsPoints: 0,\n            // Reset to 0 for the new deal\n            ewPoints: 0,\n            // Reset to 0 for the new deal\n            nsTotal: calculatedNsTotal,\n            ewTotal: calculatedEwTotal,\n            // Keep bonus scores unchanged\n            bonusNsTotal: prevState.scores.bonusNsTotal || 0,\n            bonusEwTotal: prevState.scores.bonusEwTotal || 0,\n            currentDealNumber: prevState.dealNumber + 1\n          },\n          currentDeal: {\n            dealNumber: prevState.dealNumber + 1,\n            vulnerable: determineVulnerability(prevState.dealNumber + 1),\n            contract: '',\n            result: null,\n            tricks: null,\n            nsPoints: 0,\n            ewPoints: 0,\n            rawScore: 0,\n            bonusNsPoints: 0,\n            bonusEwPoints: 0,\n            bonusRawScore: 0,\n            bonusScoringEnabled: true,\n            handAnalysis: null\n          },\n          showScorePopup: false\n        };\n      });\n\n      // NEW: Check trial status after increment\n      if (!canContinue) {\n        setTrialType('expired');\n        setShowTrialPopup(true);\n      } else if (trialManager.shouldShowWarning()) {\n        setTrialType('warning');\n        setShowTrialPopup(true);\n      }\n    }\n  };\n\n  // Function to start a new game\n  const handleNewGame = () => {\n    // Check if we're ending the current game or starting fresh\n    if (gameState.deals.length > 0) {\n      // Mark game as ended to show summary\n      setGameState(prevState => ({\n        ...prevState,\n        gameEnded: true\n      }));\n    } else {\n      // Reset the game state for a fresh start\n      setGameState({\n        gameNumber: gameState.gameNumber + 1,\n        dealNumber: 1,\n        deals: [],\n        scores: {\n          nsPoints: 0,\n          ewPoints: 0,\n          nsTotal: 0,\n          ewTotal: 0,\n          bonusNsPoints: 0,\n          bonusEwPoints: 0,\n          bonusNsTotal: 0,\n          bonusEwTotal: 0,\n          currentDealNumber: 1\n        },\n        currentDeal: {\n          dealNumber: 1,\n          vulnerable: determineVulnerability(1),\n          contract: '',\n          result: null,\n          tricks: null,\n          nsPoints: 0,\n          ewPoints: 0,\n          rawScore: 0,\n          bonusNsPoints: 0,\n          bonusEwPoints: 0,\n          bonusRawScore: 0,\n          bonusScoringEnabled: true,\n          handAnalysis: null\n        },\n        showScorePopup: false,\n        isAwake: gameState.isAwake,\n        gameEnded: false\n      });\n    }\n  };\n\n  // Function to return to the game after viewing summary\n  const handleReturnToGame = () => {\n    // Reset the game state for a fresh start\n    setGameState({\n      gameNumber: gameState.gameNumber + 1,\n      dealNumber: 1,\n      deals: [],\n      scores: {\n        nsPoints: 0,\n        ewPoints: 0,\n        nsTotal: 0,\n        ewTotal: 0,\n        bonusNsPoints: 0,\n        bonusEwPoints: 0,\n        bonusNsTotal: 0,\n        bonusEwTotal: 0,\n        currentDealNumber: 1\n      },\n      currentDeal: {\n        dealNumber: 1,\n        vulnerable: determineVulnerability(1),\n        contract: '',\n        result: null,\n        tricks: null,\n        nsPoints: 0,\n        ewPoints: 0,\n        rawScore: 0,\n        bonusNsPoints: 0,\n        bonusEwPoints: 0,\n        bonusRawScore: 0,\n        bonusScoringEnabled: true,\n        handAnalysis: null\n      },\n      showScorePopup: false,\n      isAwake: gameState.isAwake,\n      gameEnded: false\n    });\n  };\n\n  // Function to handle choosing Bonus Bridge scoring\n  const handleChooseBonusBridge = () => {\n    setCurrentView('adjustment');\n  };\n\n  // Function to handle choosing Party Bridge scoring (standard)\n  const handleChoosePartyBridge = () => {\n    // Calculate standard bridge score\n    const contractDetails = parseContract(gameState.currentDeal.contract, gameState.currentDeal.result, gameState.currentDeal.vulnerable);\n    if (contractDetails) {\n      const standardScore = calculateBridgeScore(contractDetails);\n\n      // Calculate raw score\n      const rawScore = Math.max(Math.abs(standardScore.nsPoints || 0), Math.abs(standardScore.ewPoints || 0));\n\n      // Update current deal with standard scores\n      const currentDealWithScores = {\n        ...gameState.currentDeal,\n        nsPoints: standardScore.nsPoints || 0,\n        ewPoints: standardScore.ewPoints || 0,\n        rawScore,\n        bonusScoringEnabled: false\n      };\n\n      // Calculate running totals using raw scores\n      const nsScores = standardScore.nsPoints > 0;\n      const ewScores = standardScore.ewPoints > 0;\n      const nsRawTotal = nsScores ? (gameState.scores.nsTotal || 0) + rawScore : gameState.scores.nsTotal || 0;\n      const ewRawTotal = ewScores ? (gameState.scores.ewTotal || 0) + rawScore : gameState.scores.ewTotal || 0;\n\n      // For immediate feedback of the current score\n      const updatedScores = {\n        ...gameState.scores,\n        nsPoints: standardScore.nsPoints || 0,\n        ewPoints: standardScore.ewPoints || 0,\n        nsTotal: nsRawTotal,\n        ewTotal: ewRawTotal,\n        // Important: Don't update bonus scores for Party Bridge\n        currentDealNumber: gameState.dealNumber\n      };\n\n      // Update game state with scores\n      setGameState(prevState => {\n        return {\n          ...prevState,\n          currentDeal: currentDealWithScores,\n          scores: updatedScores,\n          showScorePopup: false // Make sure popup is closed\n        };\n      });\n\n      // Then proceed to next deal after a short delay to ensure UI updates\n      setTimeout(() => {\n        handleNextDeal(currentDealWithScores, updatedScores);\n      }, 100);\n    }\n  };\n\n  // Determine which view to show - UPDATED with trial popup\n  const renderCurrentView = () => {\n    // Show trial popup if needed (highest priority)\n    if (showTrialPopup) {\n      return /*#__PURE__*/_jsxDEV(TrialPopup, {\n        trialManager: trialManager,\n        onClose: handleTrialPopupClose,\n        onExtended: handleTrialExtended,\n        type: trialType\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 689,\n        columnNumber: 9\n      }, this);\n    }\n\n    // Show welcome page\n    if (showWelcome) {\n      return /*#__PURE__*/_jsxDEV(WelcomePage, {\n        onStartGame: handleStartGame\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 700,\n        columnNumber: 14\n      }, this);\n    }\n\n    // Block access if trial expired (backup check)\n    if (trialManager.isExpired() && trialType === 'expired') {\n      return /*#__PURE__*/_jsxDEV(\"div\", {\n        style: {\n          display: 'flex',\n          alignItems: 'center',\n          justifyContent: 'center',\n          height: '100vh',\n          flexDirection: 'column',\n          textAlign: 'center',\n          padding: '20px',\n          backgroundColor: '#f5f5f5'\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          style: {\n            color: '#f44336',\n            marginBottom: '20px'\n          },\n          children: \"\\uD83D\\uDEAB Trial Period Expired\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 716,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          style: {\n            marginBottom: '20px',\n            color: '#555'\n          },\n          children: \"Your evaluation period has ended. Please contact Mike Smith for an extension.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 719,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => setShowTrialPopup(true),\n          style: {\n            padding: '12px 24px',\n            backgroundColor: '#1e5c8b',\n            color: 'white',\n            border: 'none',\n            borderRadius: '8px',\n            fontSize: '16px',\n            cursor: 'pointer'\n          },\n          children: \"Enter Extension Code\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 722,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 706,\n        columnNumber: 9\n      }, this);\n    }\n\n    // Regular app flow\n    if (gameState.gameEnded) {\n      return /*#__PURE__*/_jsxDEV(GameScoreSheet, {\n        gameState: gameState,\n        onNewGame: handleReturnToGame\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 743,\n        columnNumber: 9\n      }, this);\n    }\n    switch (currentView) {\n      case 'adjustment':\n        return /*#__PURE__*/_jsxDEV(ScoreAdjustment, {\n          currentDeal: gameState.currentDeal,\n          onSaveAdjustment: handleSaveAdjustment,\n          onCancel: () => setCurrentView('game')\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 753,\n          columnNumber: 11\n        }, this);\n      case 'analysis':\n        return /*#__PURE__*/_jsxDEV(FinalScoreAnalysis, {\n          analysisData: gameState.currentDeal.handAnalysis,\n          currentDeal: gameState.currentDeal,\n          onSave: handleSaveAnalysis,\n          onEdit: () => setCurrentView('adjustment'),\n          setGameState: setGameState,\n          scores: gameState.scores\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 761,\n          columnNumber: 11\n        }, this);\n      case 'game':\n      default:\n        return /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(ScoreProcessor, {\n            currentDeal: gameState.currentDeal,\n            onScoreCalculated: handleScoreCalculated\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 774,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(BridgeGameUI, {\n            gameState: gameState,\n            updateCurrentDeal: updateCurrentDeal,\n            onNextDeal: handleNextDeal,\n            onNewGame: handleNewGame,\n            setGameState: setGameState,\n            onChooseBonusBridge: handleChooseBonusBridge,\n            onChoosePartyBridge: handleChoosePartyBridge\n            // NEW: Pass trial info to UI (optional)\n            ,\n            remainingDeals: trialManager.getRemainingDeals(),\n            trialManager: trialManager\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 778,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"app-container\",\n    children: renderCurrentView()\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 796,\n    columnNumber: 5\n  }, this);\n};\n_s(App, \"b3mBKtU3bAyBhwcsaQwZWDcEFXU=\");\n_c = App;\nexport default App;\nvar _c;\n$RefreshReg$(_c, \"App\");","map":{"version":3,"names":["React","useState","useEffect","useCallback","WelcomePage","TrialManager","TrialPopup","BridgeGameUI","ScoreAdjustment","FinalScoreAnalysis","ScoreProcessor","GameScoreSheet","determineVulnerability","parseContract","calculateBridgeScore","jsxDEV","_jsxDEV","Fragment","_Fragment","App","_s","showWelcome","setShowWelcome","trialManager","showTrialPopup","setShowTrialPopup","trialType","setTrialType","currentView","setCurrentView","gameState","setGameState","gameNumber","dealNumber","deals","scores","nsPoints","ewPoints","nsTotal","ewTotal","bonusNsPoints","bonusEwPoints","bonusNsTotal","bonusEwTotal","currentDealNumber","currentDeal","vulnerable","contract","result","tricks","rawScore","bonusRawScore","bonusScoringEnabled","handAnalysis","showScorePopup","isAwake","gameEnded","isExpired","shouldShowWarning","isFirstVisit","sessionStorage","getItem","setItem","handleStartGame","setTimeout","handleTrialPopupClose","handleTrialExtended","handleScoreCalculated","scoreResult","console","log","prevState","updatedCurrentDeal","Math","max","abs","nsScores","ewScores","calculatedNsTotal","calculatedEwTotal","previousNsTotal","previousEwTotal","newNsTotal","newEwTotal","updatedScores","updateCurrentDeal","dealUpdates","handleSaveAdjustment","adjustmentData","handleSaveAnalysis","canPlayDeals","currentDealWithBonusScores","previousBonusNsTotal","previousBonusEwTotal","newBonusNsTotal","newBonusEwTotal","completeCurrentDeal","canContinue","incrementDeals","handleNextDeal","currentDealWithScores","dealToSave","scoresToUse","contractDetails","standardScore","handleNewGame","length","handleReturnToGame","handleChooseBonusBridge","handleChoosePartyBridge","nsRawTotal","ewRawTotal","renderCurrentView","onClose","onExtended","type","fileName","_jsxFileName","lineNumber","columnNumber","onStartGame","style","display","alignItems","justifyContent","height","flexDirection","textAlign","padding","backgroundColor","children","color","marginBottom","onClick","border","borderRadius","fontSize","cursor","onNewGame","onSaveAdjustment","onCancel","analysisData","onSave","onEdit","onScoreCalculated","onNextDeal","onChooseBonusBridge","onChoosePartyBridge","remainingDeals","getRemainingDeals","className","_c","$RefreshReg$"],"sources":["C:/Users/mikec/MikesBridge/bonusbridge/src/App.js"],"sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\r\nimport WelcomePage from './components/WelcomePage';\r\nimport TrialManager from './utils/TrialManager'; // NEW: Trial system import\r\nimport TrialPopup from './components/TrialPopup'; // NEW: Trial popup import\r\nimport BridgeGameUI from './BridgeGameUI';\r\nimport ScoreAdjustment from './components/ScoreAdjustment';\r\nimport FinalScoreAnalysis from './components/FinalScoreAnalysis';\r\nimport ScoreProcessor from './components/ScoreProcessor';\r\nimport GameScoreSheet from './components/GameScoreSheet';\r\nimport { \r\n  determineVulnerability,\r\n  parseContract,\r\n  calculateBridgeScore\r\n} from './utils/scoring';\r\nimport './global.css';\r\n\r\nconst App = () => {\r\n  // Welcome page state\r\n  const [showWelcome, setShowWelcome] = useState(true);\r\n  \r\n  // NEW: Trial management state\r\n  const [trialManager] = useState(new TrialManager());\r\n  const [showTrialPopup, setShowTrialPopup] = useState(false);\r\n  const [trialType, setTrialType] = useState('info'); // 'info', 'warning', 'expired'\r\n  \r\n  // State to track current view (main game, score adjustment, or final analysis)\r\n  const [currentView, setCurrentView] = useState('game');\r\n  \r\n  // Game state with updated scores structure\r\n  const [gameState, setGameState] = useState({\r\n    gameNumber: 1,\r\n    dealNumber: 1,\r\n    deals: [],\r\n    scores: {\r\n      // Standard bridge (Party Bridge) scores\r\n      nsPoints: 0,\r\n      ewPoints: 0,\r\n      nsTotal: 0,\r\n      ewTotal: 0,\r\n      \r\n      // Bonus Bridge scores - separate tracking\r\n      bonusNsPoints: 0,\r\n      bonusEwPoints: 0,\r\n      bonusNsTotal: 0,\r\n      bonusEwTotal: 0,\r\n      \r\n      // Track which deal number we're on\r\n      currentDealNumber: 1\r\n    },\r\n    currentDeal: {\r\n      dealNumber: 1,\r\n      vulnerable: determineVulnerability(1),\r\n      contract: '',\r\n      result: null,\r\n      tricks: null,\r\n      \r\n      // Standard bridge scores\r\n      nsPoints: 0,\r\n      ewPoints: 0,\r\n      rawScore: 0,\r\n      \r\n      // Bonus bridge scores\r\n      bonusNsPoints: 0,\r\n      bonusEwPoints: 0,\r\n      bonusRawScore: 0,\r\n      \r\n      bonusScoringEnabled: true,\r\n      handAnalysis: null\r\n    },\r\n    showScorePopup: false,\r\n    isAwake: false,\r\n    gameEnded: false\r\n  });\r\n\r\n  // NEW: Check trial status when app loads\r\n  useEffect(() => {\r\n    // Check for expiry first\r\n    if (trialManager.isExpired()) {\r\n      setTrialType('expired');\r\n      setShowTrialPopup(true);\r\n      return;\r\n    }\r\n    \r\n    // Check for warnings\r\n    if (trialManager.shouldShowWarning()) {\r\n      setTrialType('warning');\r\n      setShowTrialPopup(true);\r\n      return;\r\n    }\r\n    \r\n    // Show welcome popup on first visit (optional)\r\n    const isFirstVisit = !sessionStorage.getItem('trial_seen');\r\n    if (isFirstVisit && !showWelcome) {\r\n      setTrialType('info');\r\n      setShowTrialPopup(true);\r\n      sessionStorage.setItem('trial_seen', 'true');\r\n    }\r\n  }, [trialManager, showWelcome]);\r\n\r\n  // Function to start the game from welcome page\r\n  const handleStartGame = () => {\r\n    setShowWelcome(false);\r\n    \r\n    // Show trial info after welcome if first visit\r\n    const isFirstVisit = !sessionStorage.getItem('trial_seen');\r\n    if (isFirstVisit) {\r\n      setTimeout(() => {\r\n        setTrialType('info');\r\n        setShowTrialPopup(true);\r\n        sessionStorage.setItem('trial_seen', 'true');\r\n      }, 500);\r\n    }\r\n  };\r\n\r\n  // NEW: Handle trial popup close\r\n  const handleTrialPopupClose = () => {\r\n    // Can't close expired popup without extension\r\n    if (trialType !== 'expired') {\r\n      setShowTrialPopup(false);\r\n    }\r\n  };\r\n\r\n  // NEW: Handle trial extension\r\n  const handleTrialExtended = () => {\r\n    setShowTrialPopup(false);\r\n    // Refresh trial status\r\n    if (trialManager.shouldShowWarning()) {\r\n      setTrialType('warning');\r\n    } else {\r\n      setTrialType('info');\r\n    }\r\n  };\r\n  \r\n  // Function to handle score calculation from ScoreProcessor\r\n  const handleScoreCalculated = (scoreResult) => {\r\n    const { nsPoints, ewPoints, rawScore } = scoreResult;\r\n    \r\n    console.log('App received score calculation:', scoreResult);\r\n    \r\n    // Update the current deal with the calculated scores\r\n    setGameState(prevState => {\r\n      // Check if scores have changed\r\n      if (prevState.currentDeal.nsPoints === nsPoints && \r\n          prevState.currentDeal.ewPoints === ewPoints) {\r\n        return prevState; // No change needed\r\n      }\r\n      \r\n      const updatedCurrentDeal = {\r\n        ...prevState.currentDeal,\r\n        nsPoints,\r\n        ewPoints,\r\n        rawScore: rawScore || Math.max(Math.abs(nsPoints), Math.abs(ewPoints))\r\n      };\r\n      \r\n      // Calculate which team gets the raw score based on which has positive points\r\n      const nsScores = nsPoints > 0;\r\n      const ewScores = ewPoints > 0;\r\n      \r\n      // Calculate running totals for Party Bridge (standard) scoring\r\n      // Only add raw score to the running total of the team that scored\r\n      const calculatedNsTotal = nsScores ? \r\n        (prevState.scores.nsTotal || 0) + rawScore : \r\n        (prevState.scores.nsTotal || 0);\r\n        \r\n      const calculatedEwTotal = ewScores ? \r\n        (prevState.scores.ewTotal || 0) + rawScore : \r\n        (prevState.scores.ewTotal || 0);\r\n      \r\n      // Log the calculation details\r\n      console.log('Party Bridge (standard) score calculation:', {\r\n        previousNsTotal: prevState.scores.nsTotal || 0,\r\n        previousEwTotal: prevState.scores.ewTotal || 0,\r\n        nsScores,\r\n        ewScores,\r\n        rawScore,\r\n        newNsTotal: calculatedNsTotal,\r\n        newEwTotal: calculatedEwTotal\r\n      });\r\n      \r\n      // Updated scores with correct running totals\r\n      const updatedScores = {\r\n        ...prevState.scores,\r\n        nsPoints,\r\n        ewPoints,\r\n        nsTotal: calculatedNsTotal,\r\n        ewTotal: calculatedEwTotal,\r\n        currentDealNumber: prevState.dealNumber\r\n      };\r\n      \r\n      console.log('Updating score state:', {\r\n        currentDeal: updatedCurrentDeal,\r\n        scores: updatedScores\r\n      });\r\n      \r\n      return {\r\n        ...prevState,\r\n        currentDeal: updatedCurrentDeal,\r\n        scores: updatedScores\r\n      };\r\n    });\r\n  };\r\n  \r\n  // Function to update current deal\r\n  const updateCurrentDeal = useCallback((dealUpdates) => {\r\n    setGameState(prevState => ({\r\n      ...prevState,\r\n      currentDeal: {\r\n        ...prevState.currentDeal,\r\n        ...dealUpdates\r\n      }\r\n    }));\r\n  }, []);\r\n  \r\n  // Function to handle adjustment input\r\n  const handleSaveAdjustment = (adjustmentData) => {\r\n    setGameState(prevState => ({\r\n      ...prevState,\r\n      currentDeal: {\r\n        ...prevState.currentDeal,\r\n        handAnalysis: adjustmentData,\r\n        bonusScoringEnabled: true\r\n      }\r\n    }));\r\n    \r\n    setCurrentView('analysis');\r\n  };\r\n  \r\n  // Function to handle score analysis saving - UPDATED with trial check\r\n  const handleSaveAnalysis = (scoreResult) => {\r\n    // NEW: Check trial limit before proceeding\r\n    if (!trialManager.canPlayDeals()) {\r\n      setTrialType('expired');\r\n      setShowTrialPopup(true);\r\n      return; // Block progression\r\n    }\r\n\r\n    console.log('Handling save analysis with result:', scoreResult);\r\n    \r\n    // Extract the complete deal with bonus scores\r\n    const currentDealWithBonusScores = scoreResult.currentDealWithBonusScores || {\r\n      ...gameState.currentDeal,\r\n      dealNumber: gameState.dealNumber,\r\n      bonusNsPoints: scoreResult.nsPoints || 0,  // Store as bonus scores\r\n      bonusEwPoints: scoreResult.ewPoints || 0   // Store as bonus scores\r\n    };\r\n    \r\n    // Calculate raw score for bonus scoring if not provided\r\n    const bonusRawScore = Math.max(\r\n      Math.abs(scoreResult.nsPoints || 0),\r\n      Math.abs(scoreResult.ewPoints || 0)\r\n    );\r\n    \r\n    // Calculate running totals for bonus scoring\r\n    const nsScores = scoreResult.nsPoints > 0;\r\n    const ewScores = scoreResult.ewPoints > 0;\r\n    \r\n    const bonusNsTotal = nsScores ? \r\n      (gameState.scores.bonusNsTotal || 0) + bonusRawScore : \r\n      (gameState.scores.bonusNsTotal || 0);\r\n    \r\n    const bonusEwTotal = ewScores ? \r\n      (gameState.scores.bonusEwTotal || 0) + bonusRawScore : \r\n      (gameState.scores.bonusEwTotal || 0);\r\n    \r\n    console.log('Bonus Bridge score calculation:', {\r\n      nsScores,\r\n      ewScores,\r\n      bonusRawScore,\r\n      previousBonusNsTotal: gameState.scores.bonusNsTotal || 0,\r\n      previousBonusEwTotal: gameState.scores.bonusEwTotal || 0,\r\n      newBonusNsTotal: bonusNsTotal,\r\n      newBonusEwTotal: bonusEwTotal\r\n    });\r\n    \r\n    // Store the complete deal with both raw and bonus scores\r\n    const completeCurrentDeal = {\r\n      ...currentDealWithBonusScores,\r\n      rawScore: currentDealWithBonusScores.rawScore || 0,  // Party Bridge score\r\n      bonusRawScore: bonusRawScore,                        // Bonus Bridge score\r\n      nsPoints: currentDealWithBonusScores.nsPoints || 0,  // Party Bridge points\r\n      ewPoints: currentDealWithBonusScores.ewPoints || 0,  // Party Bridge points\r\n      bonusNsPoints: scoreResult.nsPoints || 0,            // Bonus Bridge points\r\n      bonusEwPoints: scoreResult.ewPoints || 0             // Bonus Bridge points\r\n    };\r\n\r\n    // NEW: Increment deal counter\r\n    const canContinue = trialManager.incrementDeals();\r\n    \r\n    // Update game state with new deal\r\n    setGameState(prevState => {\r\n      return {\r\n        ...prevState,\r\n        dealNumber: prevState.dealNumber + 1,\r\n        deals: [...prevState.deals, completeCurrentDeal],\r\n        scores: {\r\n          ...prevState.scores,\r\n          // Reset current deal scores to 0\r\n          nsPoints: 0,\r\n          ewPoints: 0,\r\n          // Preserve running totals for both scoring systems\r\n          nsTotal: prevState.scores.nsTotal || 0,\r\n          ewTotal: prevState.scores.ewTotal || 0,\r\n          bonusNsTotal: bonusNsTotal,\r\n          bonusEwTotal: bonusEwTotal,\r\n          currentDealNumber: prevState.dealNumber + 1\r\n        },\r\n        currentDeal: {\r\n          dealNumber: prevState.dealNumber + 1,\r\n          vulnerable: determineVulnerability(prevState.dealNumber + 1),\r\n          contract: '',\r\n          result: null,\r\n          tricks: null,\r\n          nsPoints: 0,\r\n          ewPoints: 0,\r\n          rawScore: 0,\r\n          bonusNsPoints: 0,\r\n          bonusEwPoints: 0,\r\n          bonusRawScore: 0,\r\n          bonusScoringEnabled: true,\r\n          handAnalysis: null\r\n        },\r\n        showScorePopup: false\r\n      };\r\n    });\r\n\r\n    // NEW: Check trial status after increment\r\n    if (!canContinue) {\r\n      setTrialType('expired');\r\n      setShowTrialPopup(true);\r\n    } else if (trialManager.shouldShowWarning()) {\r\n      setTrialType('warning');\r\n      setShowTrialPopup(true);\r\n    }\r\n    \r\n    // Return to the game view\r\n    setCurrentView('game');\r\n  };\r\n  \r\n  // Function to handle next deal without adjustments - UPDATED with trial check\r\n  const handleNextDeal = (currentDealWithScores = null, updatedScores = null) => {\r\n    // NEW: Check trial limit before proceeding\r\n    if (!trialManager.canPlayDeals()) {\r\n      setTrialType('expired');\r\n      setShowTrialPopup(true);\r\n      return; // Block progression\r\n    }\r\n\r\n    // Use provided scores or current state\r\n    const dealToSave = currentDealWithScores || gameState.currentDeal;\r\n    const scoresToUse = updatedScores || gameState.scores;\r\n    \r\n    // Ensure the deal has scores\r\n    if (!dealToSave.nsPoints && !dealToSave.ewPoints && dealToSave.contract) {\r\n      // Calculate if needed\r\n      const contractDetails = parseContract(\r\n        dealToSave.contract, \r\n        dealToSave.result, \r\n        dealToSave.vulnerable\r\n      );\r\n      \r\n      if (contractDetails) {\r\n        const standardScore = calculateBridgeScore(contractDetails);\r\n        \r\n        // Calculate raw score\r\n        const rawScore = Math.max(\r\n          Math.abs(standardScore.nsPoints || 0), \r\n          Math.abs(standardScore.ewPoints || 0)\r\n        );\r\n        \r\n        // Update scores\r\n        dealToSave.nsPoints = standardScore.nsPoints || 0;\r\n        dealToSave.ewPoints = standardScore.ewPoints || 0;\r\n        dealToSave.rawScore = rawScore;\r\n        \r\n        // Determine which team scores positive points\r\n        const nsScores = standardScore.nsPoints > 0;\r\n        const ewScores = standardScore.ewPoints > 0;\r\n        \r\n        // Calculate running totals for Party Bridge\r\n        const calculatedNsTotal = nsScores ? \r\n          (scoresToUse.nsTotal || 0) + rawScore : \r\n          (scoresToUse.nsTotal || 0);\r\n        \r\n        const calculatedEwTotal = ewScores ? \r\n          (scoresToUse.ewTotal || 0) + rawScore : \r\n          (scoresToUse.ewTotal || 0);\r\n        \r\n        console.log('Next deal Party Bridge score calculation:', {\r\n          nsScores, \r\n          ewScores, \r\n          rawScore, \r\n          previousNsTotal: scoresToUse.nsTotal || 0,\r\n          previousEwTotal: scoresToUse.ewTotal || 0,\r\n          newNsTotal: calculatedNsTotal,\r\n          newEwTotal: calculatedEwTotal\r\n        });\r\n\r\n        // NEW: Increment deal counter\r\n        const canContinue = trialManager.incrementDeals();\r\n        \r\n        // Update game state with new deal\r\n        setGameState(prevState => {\r\n          return {\r\n            ...prevState,\r\n            dealNumber: prevState.dealNumber + 1,\r\n            deals: [...prevState.deals, dealToSave],\r\n            scores: {\r\n              ...prevState.scores,\r\n              nsPoints: 0, // Reset to 0 for the new deal\r\n              ewPoints: 0, // Reset to 0 for the new deal\r\n              nsTotal: calculatedNsTotal,\r\n              ewTotal: calculatedEwTotal,\r\n              // Keep bonus scores unchanged\r\n              bonusNsTotal: prevState.scores.bonusNsTotal || 0,\r\n              bonusEwTotal: prevState.scores.bonusEwTotal || 0,\r\n              currentDealNumber: prevState.dealNumber + 1\r\n            },\r\n            currentDeal: {\r\n              dealNumber: prevState.dealNumber + 1,\r\n              vulnerable: determineVulnerability(prevState.dealNumber + 1),\r\n              contract: '',\r\n              result: null,\r\n              tricks: null,\r\n              nsPoints: 0,\r\n              ewPoints: 0,\r\n              rawScore: 0,\r\n              bonusNsPoints: 0,\r\n              bonusEwPoints: 0,\r\n              bonusRawScore: 0,\r\n              bonusScoringEnabled: true,\r\n              handAnalysis: null\r\n            },\r\n            showScorePopup: false\r\n          };\r\n        });\r\n\r\n        // NEW: Check trial status after increment\r\n        if (!canContinue) {\r\n          setTrialType('expired');\r\n          setShowTrialPopup(true);\r\n        } else if (trialManager.shouldShowWarning()) {\r\n          setTrialType('warning');\r\n          setShowTrialPopup(true);\r\n        }\r\n      }\r\n    } else {\r\n      // Already has scores, just save and proceed\r\n      const rawScore = dealToSave.rawScore || Math.max(\r\n        Math.abs(dealToSave.nsPoints || 0), \r\n        Math.abs(dealToSave.ewPoints || 0)\r\n      );\r\n      \r\n      const nsScores = dealToSave.nsPoints > 0;\r\n      const ewScores = dealToSave.ewPoints > 0;\r\n      \r\n      const calculatedNsTotal = nsScores ? \r\n        (scoresToUse.nsTotal || 0) + rawScore : \r\n        (scoresToUse.nsTotal || 0);\r\n      \r\n      const calculatedEwTotal = ewScores ? \r\n        (scoresToUse.ewTotal || 0) + rawScore : \r\n        (scoresToUse.ewTotal || 0);\r\n      \r\n      console.log('Next deal with existing scores:', {\r\n        nsScores, \r\n        ewScores, \r\n        rawScore, \r\n        previousNsTotal: scoresToUse.nsTotal || 0,\r\n        previousEwTotal: scoresToUse.ewTotal || 0,\r\n        newNsTotal: calculatedNsTotal,\r\n        newEwTotal: calculatedEwTotal\r\n      });\r\n\r\n      // NEW: Increment deal counter\r\n      const canContinue = trialManager.incrementDeals();\r\n      \r\n      // Update game state with new deal\r\n      setGameState(prevState => {\r\n        return {\r\n          ...prevState,\r\n          dealNumber: prevState.dealNumber + 1,\r\n          deals: [...prevState.deals, dealToSave],\r\n          scores: {\r\n            ...prevState.scores,\r\n            nsPoints: 0, // Reset to 0 for the new deal\r\n            ewPoints: 0, // Reset to 0 for the new deal\r\n            nsTotal: calculatedNsTotal,\r\n            ewTotal: calculatedEwTotal,\r\n            // Keep bonus scores unchanged\r\n            bonusNsTotal: prevState.scores.bonusNsTotal || 0,\r\n            bonusEwTotal: prevState.scores.bonusEwTotal || 0,\r\n            currentDealNumber: prevState.dealNumber + 1\r\n          },\r\n          currentDeal: {\r\n            dealNumber: prevState.dealNumber + 1,\r\n            vulnerable: determineVulnerability(prevState.dealNumber + 1),\r\n            contract: '',\r\n            result: null,\r\n            tricks: null,\r\n            nsPoints: 0,\r\n            ewPoints: 0,\r\n            rawScore: 0,\r\n            bonusNsPoints: 0,\r\n            bonusEwPoints: 0,\r\n            bonusRawScore: 0,\r\n            bonusScoringEnabled: true,\r\n            handAnalysis: null\r\n          },\r\n          showScorePopup: false\r\n        };\r\n      });\r\n\r\n      // NEW: Check trial status after increment\r\n      if (!canContinue) {\r\n        setTrialType('expired');\r\n        setShowTrialPopup(true);\r\n      } else if (trialManager.shouldShowWarning()) {\r\n        setTrialType('warning');\r\n        setShowTrialPopup(true);\r\n      }\r\n    }\r\n  };\r\n  \r\n  // Function to start a new game\r\n  const handleNewGame = () => {\r\n    // Check if we're ending the current game or starting fresh\r\n    if (gameState.deals.length > 0) {\r\n      // Mark game as ended to show summary\r\n      setGameState(prevState => ({\r\n        ...prevState,\r\n        gameEnded: true\r\n      }));\r\n    } else {\r\n      // Reset the game state for a fresh start\r\n      setGameState({\r\n        gameNumber: gameState.gameNumber + 1,\r\n        dealNumber: 1,\r\n        deals: [],\r\n        scores: {\r\n          nsPoints: 0,\r\n          ewPoints: 0,\r\n          nsTotal: 0,\r\n          ewTotal: 0,\r\n          bonusNsPoints: 0,\r\n          bonusEwPoints: 0,\r\n          bonusNsTotal: 0,\r\n          bonusEwTotal: 0,\r\n          currentDealNumber: 1\r\n        },\r\n        currentDeal: {\r\n          dealNumber: 1,\r\n          vulnerable: determineVulnerability(1),\r\n          contract: '',\r\n          result: null,\r\n          tricks: null,\r\n          nsPoints: 0,\r\n          ewPoints: 0,\r\n          rawScore: 0,\r\n          bonusNsPoints: 0,\r\n          bonusEwPoints: 0,\r\n          bonusRawScore: 0,\r\n          bonusScoringEnabled: true,\r\n          handAnalysis: null\r\n        },\r\n        showScorePopup: false,\r\n        isAwake: gameState.isAwake,\r\n        gameEnded: false\r\n      });\r\n    }\r\n  };\r\n  \r\n  // Function to return to the game after viewing summary\r\n  const handleReturnToGame = () => {\r\n    // Reset the game state for a fresh start\r\n    setGameState({\r\n      gameNumber: gameState.gameNumber + 1,\r\n      dealNumber: 1,\r\n      deals: [],\r\n      scores: {\r\n        nsPoints: 0,\r\n        ewPoints: 0,\r\n        nsTotal: 0,\r\n        ewTotal: 0,\r\n        bonusNsPoints: 0,\r\n        bonusEwPoints: 0,\r\n        bonusNsTotal: 0,\r\n        bonusEwTotal: 0,\r\n        currentDealNumber: 1\r\n      },\r\n      currentDeal: {\r\n        dealNumber: 1,\r\n        vulnerable: determineVulnerability(1),\r\n        contract: '',\r\n        result: null,\r\n        tricks: null,\r\n        nsPoints: 0,\r\n        ewPoints: 0,\r\n        rawScore: 0,\r\n        bonusNsPoints: 0,\r\n        bonusEwPoints: 0,\r\n        bonusRawScore: 0,\r\n        bonusScoringEnabled: true,\r\n        handAnalysis: null\r\n      },\r\n      showScorePopup: false,\r\n      isAwake: gameState.isAwake,\r\n      gameEnded: false\r\n    });\r\n  };\r\n  \r\n  // Function to handle choosing Bonus Bridge scoring\r\n  const handleChooseBonusBridge = () => {\r\n    setCurrentView('adjustment');\r\n  };\r\n  \r\n  // Function to handle choosing Party Bridge scoring (standard)\r\n  const handleChoosePartyBridge = () => {\r\n    // Calculate standard bridge score\r\n    const contractDetails = parseContract(\r\n      gameState.currentDeal.contract, \r\n      gameState.currentDeal.result, \r\n      gameState.currentDeal.vulnerable\r\n    );\r\n    \r\n    if (contractDetails) {\r\n      const standardScore = calculateBridgeScore(contractDetails);\r\n      \r\n      // Calculate raw score\r\n      const rawScore = Math.max(\r\n        Math.abs(standardScore.nsPoints || 0), \r\n        Math.abs(standardScore.ewPoints || 0)\r\n      );\r\n      \r\n      // Update current deal with standard scores\r\n      const currentDealWithScores = {\r\n        ...gameState.currentDeal,\r\n        nsPoints: standardScore.nsPoints || 0,\r\n        ewPoints: standardScore.ewPoints || 0,\r\n        rawScore,\r\n        bonusScoringEnabled: false\r\n      };\r\n      \r\n      // Calculate running totals using raw scores\r\n      const nsScores = standardScore.nsPoints > 0;\r\n      const ewScores = standardScore.ewPoints > 0;\r\n      \r\n      const nsRawTotal = nsScores ? \r\n        (gameState.scores.nsTotal || 0) + rawScore : \r\n        (gameState.scores.nsTotal || 0);\r\n      \r\n      const ewRawTotal = ewScores ? \r\n        (gameState.scores.ewTotal || 0) + rawScore : \r\n        (gameState.scores.ewTotal || 0);\r\n      \r\n      // For immediate feedback of the current score\r\n      const updatedScores = {\r\n        ...gameState.scores,\r\n        nsPoints: standardScore.nsPoints || 0,\r\n        ewPoints: standardScore.ewPoints || 0,\r\n        nsTotal: nsRawTotal,\r\n        ewTotal: ewRawTotal,\r\n        \r\n        // Important: Don't update bonus scores for Party Bridge\r\n        currentDealNumber: gameState.dealNumber\r\n      };\r\n      \r\n      // Update game state with scores\r\n      setGameState(prevState => {\r\n        return {\r\n          ...prevState,\r\n          currentDeal: currentDealWithScores,\r\n          scores: updatedScores,\r\n          showScorePopup: false // Make sure popup is closed\r\n        };\r\n      });\r\n      \r\n      // Then proceed to next deal after a short delay to ensure UI updates\r\n      setTimeout(() => {\r\n        handleNextDeal(currentDealWithScores, updatedScores);\r\n      }, 100);\r\n    }\r\n  };\r\n  \r\n  // Determine which view to show - UPDATED with trial popup\r\n  const renderCurrentView = () => {\r\n    // Show trial popup if needed (highest priority)\r\n    if (showTrialPopup) {\r\n      return (\r\n        <TrialPopup\r\n          trialManager={trialManager}\r\n          onClose={handleTrialPopupClose}\r\n          onExtended={handleTrialExtended}\r\n          type={trialType}\r\n        />\r\n      );\r\n    }\r\n\r\n    // Show welcome page\r\n    if (showWelcome) {\r\n      return <WelcomePage onStartGame={handleStartGame} />;\r\n    }\r\n\r\n    // Block access if trial expired (backup check)\r\n    if (trialManager.isExpired() && trialType === 'expired') {\r\n      return (\r\n        <div style={{\r\n          display: 'flex',\r\n          alignItems: 'center',\r\n          justifyContent: 'center',\r\n          height: '100vh',\r\n          flexDirection: 'column',\r\n          textAlign: 'center',\r\n          padding: '20px',\r\n          backgroundColor: '#f5f5f5'\r\n        }}>\r\n          <h2 style={{ color: '#f44336', marginBottom: '20px' }}>\r\n             Trial Period Expired\r\n          </h2>\r\n          <p style={{ marginBottom: '20px', color: '#555' }}>\r\n            Your evaluation period has ended. Please contact Mike Smith for an extension.\r\n          </p>\r\n          <button \r\n            onClick={() => setShowTrialPopup(true)}\r\n            style={{\r\n              padding: '12px 24px',\r\n              backgroundColor: '#1e5c8b',\r\n              color: 'white',\r\n              border: 'none',\r\n              borderRadius: '8px',\r\n              fontSize: '16px',\r\n              cursor: 'pointer'\r\n            }}\r\n          >\r\n            Enter Extension Code\r\n          </button>\r\n        </div>\r\n      );\r\n    }\r\n\r\n    // Regular app flow\r\n    if (gameState.gameEnded) {\r\n      return (\r\n        <GameScoreSheet \r\n          gameState={gameState}\r\n          onNewGame={handleReturnToGame}\r\n        />\r\n      );\r\n    }\r\n    \r\n    switch(currentView) {\r\n      case 'adjustment':\r\n        return (\r\n          <ScoreAdjustment \r\n            currentDeal={gameState.currentDeal}\r\n            onSaveAdjustment={handleSaveAdjustment}\r\n            onCancel={() => setCurrentView('game')}\r\n          />\r\n        );\r\n      case 'analysis':\r\n        return (\r\n          <FinalScoreAnalysis \r\n            analysisData={gameState.currentDeal.handAnalysis}\r\n            currentDeal={gameState.currentDeal}\r\n            onSave={handleSaveAnalysis}\r\n            onEdit={() => setCurrentView('adjustment')}\r\n            setGameState={setGameState}\r\n            scores={gameState.scores}\r\n          />\r\n        );\r\n      case 'game':\r\n      default:\r\n        return (\r\n          <>\r\n            <ScoreProcessor \r\n              currentDeal={gameState.currentDeal}\r\n              onScoreCalculated={handleScoreCalculated}\r\n            />\r\n            <BridgeGameUI \r\n              gameState={gameState}\r\n              updateCurrentDeal={updateCurrentDeal}\r\n              onNextDeal={handleNextDeal}\r\n              onNewGame={handleNewGame}\r\n              setGameState={setGameState}\r\n              onChooseBonusBridge={handleChooseBonusBridge}\r\n              onChoosePartyBridge={handleChoosePartyBridge}\r\n              // NEW: Pass trial info to UI (optional)\r\n              remainingDeals={trialManager.getRemainingDeals()}\r\n              trialManager={trialManager}\r\n            />\r\n          </>\r\n        );\r\n    }\r\n  };\r\n  \r\n  return (\r\n    <div className=\"app-container\">\r\n      {renderCurrentView()}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default App;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}